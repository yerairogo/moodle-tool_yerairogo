{"version":3,"file":"confirmation.min.js","sources":["../src/confirmation.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Confirms the deletion of an entry\n *\n * @module     tool_yerairogo/confirmation\n * @copyright  2025 Yerai Rodr√≠guez <yerai.rodriguez@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport * as str from 'core/str';\nimport * as notification from 'core/notification';\nimport * as templates from 'core/templates';\nimport * as ajax from 'core/ajax';\n\n/**\n * Displays the confirmation to delete the entry\n *\n * @method confirmDeletion\n * @param {Number} id\n * @param {Object} entriesList\n */\nexport const confirmDeletion = (id, entriesList) => {\n    str.get_strings([\n            {key: 'delete'},\n            {key: 'confirmdeletion', component: 'tool_yerairogo'},\n            {key: 'yes'},\n            {key: 'no'}\n        ])\n        .then(function(strings) {\n            return notification.confirm(strings[0], strings[1], strings[2], strings[3], function() {\n                processDelete(id, entriesList);\n            });\n        })\n        .catch(notification.exception);\n};\n\n/**\n * Calls the services to delete the entry and retrieve the entries list\n *\n * @method processDelete\n * @param {Number} id\n * @param {Object} entriesList\n */\nexport const processDelete = (id, entriesList) => {\n    const courseid = entriesList.dataset.courseid;\n    const requests = ajax.call([{\n        methodname: 'tool_yerairogo_delete_entry',\n        args: {id: id}\n    }, {\n        methodname: 'tool_yerairogo_list_entries',\n        args: {courseid: courseid}\n    }]);\n    requests[1].then(function(data) {\n        return loadList(data, entriesList);\n    }).catch(notification.exception);\n};\n\n/**\n * Loads and renders the entries list\n *\n * @method loadList\n * @param {Object} data\n * @param {Object} entriesList\n */\nexport const loadList = (data, entriesList) => {\n    templates.render('tool_yerairogo/entries_list', data).then(function(html, js) {\n        return templates.replaceNodeContents(entriesList, html, js);\n    }).catch(notification.exception);\n};\n\n/**\n * Binds click event to the selector\n *\n * @method onClickHandler\n * @param {String} selector\n */\nexport const onClickHandler = (selector) => {\n    const items = document.querySelectorAll(selector);\n\n    items.forEach((item) => {\n        item.addEventListener(\"click\", (e) => {\n            e.preventDefault();\n            const id = item.dataset.entryid;\n            const entriesList = item.closest('.entries_list');\n            confirmDeletion(id, entriesList);\n        });\n    });\n};\n\n/**\n * Initialises the confirmation to delete the entry\n *\n * @method init\n * @param {String} selector\n */\nexport const init = (selector) => {\n    onClickHandler(selector);\n};\n"],"names":["confirmDeletion","id","entriesList","str","get_strings","key","component","then","strings","notification","confirm","processDelete","catch","exception","courseid","dataset","ajax","call","methodname","args","data","loadList","templates","render","html","js","replaceNodeContents","onClickHandler","selector","document","querySelectorAll","forEach","item","addEventListener","e","preventDefault","entryid","closest"],"mappings":";;;;;;;sVAmCaA,gBAAkB,CAACC,GAAIC,eAChCC,IAAIC,YAAY,CACR,CAACC,IAAK,UACN,CAACA,IAAK,kBAAmBC,UAAW,kBACpC,CAACD,IAAK,OACN,CAACA,IAAK,QAETE,MAAK,SAASC,gBACJC,aAAaC,QAAQF,QAAQ,GAAIA,QAAQ,GAAIA,QAAQ,GAAIA,QAAQ,IAAI,WACxEG,cAAcV,GAAIC,mBAGzBU,MAAMH,aAAaI,2DAUfF,cAAgB,CAACV,GAAIC,qBACxBY,SAAWZ,YAAYa,QAAQD,SACpBE,KAAKC,KAAK,CAAC,CACxBC,WAAY,8BACZC,KAAM,CAAClB,GAAIA,KACZ,CACCiB,WAAY,8BACZC,KAAM,CAACL,SAAUA,aAEZ,GAAGP,MAAK,SAASa,aACfC,SAASD,KAAMlB,gBACvBU,MAAMH,aAAaI,uDAUbQ,SAAW,CAACD,KAAMlB,eAC3BoB,UAAUC,OAAO,8BAA+BH,MAAMb,MAAK,SAASiB,KAAMC,WAC/DH,UAAUI,oBAAoBxB,YAAasB,KAAMC,OACzDb,MAAMH,aAAaI,6CASbc,eAAkBC,WACbC,SAASC,iBAAiBF,UAElCG,SAASC,OACXA,KAAKC,iBAAiB,SAAUC,IAC5BA,EAAEC,uBACIlC,GAAK+B,KAAKjB,QAAQqB,QAClBlC,YAAc8B,KAAKK,QAAQ,iBACjCrC,gBAAgBC,GAAIC,yEAWX0B,WACjBD,eAAeC"}